var ZUSE=ZUSE||{};$(function(){$("#tabs").tabs({collapsible:!0,select:function(b,c){3===c.index?ZUSE.adderObj.selection.setActivation(!0):ZUSE.adderObj.selection.setActivation(!1)}});$("#resetView").button();$("#resetSelection").button();$("#resetSelection2").button();$("#showCircuit").button();$("#highlightMoving").button();$("#highlightEverything").button();$("#inputBack").button();$("#inputRepeat").button();$("#inputNext").button();$("#layerExpand").buttonset();$("#sliderX").slider({range:!0,min:0,max:1E3,values:[0,
1E3],slide:function(b,c){ZUSE.adderObj.selection.setFromSlider("x",c.values[0],c.values[1])}});$("#sliderY").slider({range:!0,min:0,max:1E3,values:[0,1E3],slide:function(b,c){ZUSE.adderObj.selection.setFromSlider("y",c.values[0],c.values[1])}});$("#sliderZ").slider({range:!0,min:0,max:8,values:[0,8],slide:function(b,c){ZUSE.adderObj.selection.setFromSlider("z",c.values[0],c.values[1])}});$("#sliderCircuit").slider({range:"min",min:320,max:1E3,value:520,slide:function(b,c){document.getElementById("svgCircuit").setAttribute("width",
c.value+"px");document.getElementById("svgCircuit").setAttribute("height",c.value/2+"px");document.getElementById("floatingCircuit").style.width=c.value+20+"px";document.getElementById("svgCircuit").style.width=c.value+"px"}});$("#floatingCircuit").draggable();$("#sliderMovingSheet").slider({range:"min",min:0,max:100,value:100,slide:function(b,c){ZUSE.Materials.MovingSheet.transparency.value=c.value/100}});$("#sliderStaticSheet").slider({range:"min",min:0,max:100,value:100,slide:function(b,c){ZUSE.Materials.StaticSheet.transparency.value=
c.value/100}});$("#sliderIntermediateSheet").slider({range:"min",min:0,max:100,value:100,slide:function(b,c){ZUSE.Materials.IntermediateSheet.transparency.value=c.value/100}});$("#sliderMovingPin").slider({range:"min",min:0,max:100,value:100,slide:function(b,c){ZUSE.Materials.MovingPin.transparency.value=c.value/100}});$("#sliderStaticPin").slider({range:"min",min:0,max:100,value:100,slide:function(b,c){ZUSE.Materials.StaticPin.transparency.value=c.value/100}});$("#sliderClippingTransparency").slider({range:"min",
min:0,max:100,value:0,slide:function(b,c){ZUSE.ShaderUniforms.clippingTransparency.value=c.value/100}});$("#sliderFadingWidth").slider({range:"min",min:0,max:100,value:0,slide:function(b,c){ZUSE.ShaderUniforms.fadingWidth.value=c.value}})});THREE.Path.prototype.moveBy=function(b,c){1===this.actions.length&&(this.actions[0].args[0]+=b,this.actions[0].args[1]+=c)};THREE.Path.prototype.lineBy=function(b,c){var d=this.actions[this.actions.length-1].args;this.lineTo(d[d.length-2]+b,d[d.length-1]+c)};THREE.Path.prototype.stepSize=0;THREE.Path.prototype.setStepSize=function(b){this.stepSize=Math.floor(Math.abs(b))};
THREE.Path.prototype.stepBy=function(b,c){if(0!=b&&0!=c)this.lineBy(b,c);else if(0!=b&&0==c)if(0==this.stepSize)this.lineBy(b,0);else{for(var d=Math.abs(b),e=b/d,f=Math.floor(d/this.stepSize),g=0;g<f;g++)this.lineBy(this.stepSize*e,0);d%=this.stepSize;0!=d&&this.lineBy(d*e,0)}else if(0==b&&0!=c)if(0==this.stepSize)this.lineBy(0,c);else{d=Math.abs(c);e=c/d;f=Math.floor(d/this.stepSize);for(g=0;g<f;g++)this.lineBy(0,this.stepSize*e);d%=this.stepSize;0!=d&&this.lineBy(0,d*e)}};
THREE.Path.prototype.quadraticCurveBy=function(b,c,d,e){var f=this.actions[this.actions.length-1].args,g=f[f.length-2],f=f[f.length-1],h=new THREE.QuadraticBezierCurve(new THREE.Vector2(g,f),new THREE.Vector2(b+g,c+f),new THREE.Vector2(d+g,e+f));this.curves.push(h);this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:[b+g,c+f,d+g,e+f]})};
THREE.Path.prototype.arcBy=function(b,c){var d=this.actions[this.actions.length-1].args,e=d[d.length-2],d=d[d.length-1],f=Math.abs(b+c),g=(b+c)/f,h=e+b/2,k=d+c/2,f=-f/2,i=Math.PI*((0!==b?1:2)-g)/2,g=Math.PI*((0!==b?3:4)-g)/2,j=new THREE.ArcCurve(h,k,f,i,g,!0);this.curves.push(j);this.actions.push({action:THREE.PathActions.ARC,args:[h,k,f,i,g,!0,e+b,d+c]})};
THREE.Path.prototype.quarterArc=function(b){var c=this.actions[this.actions.length-1].args,d=c[c.length-2],c=c[c.length-1],e=d+b,f=-b,g=Math.PI/2,h=new THREE.ArcCurve(e,c,f,0,g,!0);this.curves.push(h);this.actions.push({action:THREE.PathActions.ARC,args:[e,c,f,0,g,!0,d+b,c-b]})};
THREE.Path.prototype.circle=function(b){if(1===this.actions.length){var c=this.actions[0].args[0],d=this.actions[0].args[1],e=2*Math.PI;this.actions[0].args[0]+=b;var f=new THREE.ArcCurve(c,d,b,0,e,!0);this.curves.push(f);this.actions.push({action:THREE.PathActions.ARC,args:[c,d,b,0,e,!0,c+b,d]})}};ZUSE.CameraControls=function(b){function c(b){f==e.NONE&&(b.wheelDelta?l=0<=b.wheelDelta?1:-1:b.detail&&(l=0>=b.detail?1:-1))}var d=this,e={NONE:-1,ROTATE:0,PAN:1},f=e.NONE;this.screen={width:window.innerWidth,height:window.innerHeight,offsetLeft:0,offsetTop:0};this.radius=(this.screen.width+this.screen.height)/4;this.rotateSpeed=1;this.panSpeed=0.8;this.dynamicDampingFactor=0.2;this.minDistance=0;this.maxDistance=Infinity;this.camera=b;this.target=new THREE.Vector3;var g=new THREE.Vector3,h=new THREE.Vector3,
k=new THREE.Vector3,i=new THREE.Vector2,j=new THREE.Vector2,l;this.handleEvent=function(b){if("function"==typeof this[b.type])this[b.type](b)};this.getMouseOnScreen=function(b,c){return new THREE.Vector2(0.5*((b-this.screen.offsetLeft)/this.radius),0.5*((c-this.screen.offsetTop)/this.radius))};this.getMouseProjectionOnBall=function(b,c){var d=new THREE.Vector3((b-0.5*this.screen.width-this.screen.offsetLeft)/this.radius,(0.5*this.screen.height+this.screen.offsetTop-c)/this.radius,0),f=d.length();
1<f?d.normalize():d.z=Math.sqrt(1-f*f);g.copy(this.camera.position).subSelf(this.target);f=this.camera.up.clone().setLength(d.y);f.addSelf(this.camera.up.clone().crossSelf(g).setLength(d.x));f.addSelf(g.setLength(d.z));return f};this.rotateCamera=function(){var b=Math.acos(h.dot(k)/h.length()/k.length());if(b){var c=(new THREE.Vector3).cross(h,k).normalize(),b=b*this.rotateSpeed,d=new THREE.Quaternion;d.setFromAxisAngle(c,-b);d.multiplyVector3(g);d.multiplyVector3(this.camera.up);d.multiplyVector3(k);
d.setFromAxisAngle(c,b*(this.dynamicDampingFactor-1));d.multiplyVector3(h)}};this.zoomCamera=function(){var b=1-l/10;1!=b&&0<b&&this.target.addSelf(g.clone().normalize().multiplyScalar(-30*l));l*=0.5};this.panCamera=function(){var b=j.clone().subSelf(i);if(0<b.lengthSq()){b.multiplyScalar(g.length()*this.panSpeed);var c=g.clone().crossSelf(this.camera.up).setLength(b.x);c.addSelf(this.camera.up.clone().setLength(b.y));this.camera.position.addSelf(c);this.target.addSelf(c);i.addSelf(b.sub(j,i).multiplyScalar(this.dynamicDampingFactor))}};
this.levelCamera=function(){var b=this.camera.up.clone(),c=(new THREE.Vector3(0,1,0)).crossSelf(g).crossSelf(g).negate(),d=Math.acos(b.dot(c)/b.length()/c.length());if(d){var f=g.clone().normalize(),b=0<=b.clone().crossSelf(c).dot(g)?1:-1,c=new THREE.Quaternion;c.setFromAxisAngle(f,b*d);c.multiplyVector3(this.camera.up)}};this.checkDistances=function(){this.camera.position.lengthSq()>this.maxDistance*this.maxDistance&&this.camera.position.setLength(this.maxDistance);g.lengthSq()<this.minDistance*
this.minDistance&&this.camera.position.add(this.target,g.setLength(this.minDistance))};this.update=function(){g.copy(this.camera.position).subSelf(this.target);this.zoomCamera();this.rotateCamera();this.panCamera();this.camera.position.add(this.target,g);this.checkDistances();this.camera.lookAt(this.target)};this.reset=function(){this.camera.position.set(400,-400,400);this.target.set(140,120,160);this.camera.up.set(0,0,1)};window.addEventListener("mousedown",function(b){0===b.button&&!ZUSE.INTERSECTED&&
(b.preventDefault(),b.stopPropagation(),b.shiftKey?(f=e.PAN,i=j=d.getMouseOnScreen(b.clientX,b.clientY)):(f=e.ROTATE,h=k=d.getMouseProjectionOnBall(b.clientX,b.clientY)))},!1);window.addEventListener("mousemove",function(b){f==e.ROTATE?k=d.getMouseProjectionOnBall(b.clientX,b.clientY):f==e.PAN&&(j=d.getMouseOnScreen(b.clientX,b.clientY))},!1);window.addEventListener("mouseup",function(b){b.preventDefault();b.stopPropagation();f=e.NONE},!1);window.addEventListener("mousewheel",c,!1);window.addEventListener("DOMMouseScroll",
c,!1)};ZUSE.SheetTypes={SHEET_AA:"AA",SHEET_AB:"AB",SHEET_AD:"AD",SHEET_AE:"AE",SHEET_AG:"AG",SHEET_AP:"AP",SHEET_BA:"BA",SHEET_BB:"BB",SHEET_BC:"BC",SHEET_BF:"BF",SHEET_BF0:"BF0",SHEET_BF4:"BF4",SHEET_BG:"BG",SHEET_BH:"BH",SHEET_BN:"BN",SHEET_BQ0:"BQ0",SHEET_BQ1:"BQ1",SHEET_CF:"CF",SHEET_CG:"CG",SHEET_CJ:"CJ",SHEET_CK:"CK",SHEET_CM:"CM",SHEET_CR:"CR",SHEET_CS:"CS",SHEET_CT:"CT",SHEET_CU:"CU",SHEET_CV:"CV",SHEET_CW0:"CW0",SHEET_CW1:"CW1",SHEET_DF:"DF",SHEET_DG:"DG",SHEET_DJ:"DJ",SHEET_DK:"DK",SHEET_DM:"DM",
SHEET_DR:"DR",SHEET_DS:"DS",SHEET_DT:"DT",SHEET_DU:"DU",SHEET_DV:"DV",SHEET_DW0:"DW0",SHEET_DW1:"DW1",SHEET_Z0A:"Z0A",SHEET_ZAB:"ZAB",SHEET_ZBC:"ZBC",SHEET_ZCD:"ZCD",SHEET_ZD0:"ZD0"};ZUSE.ShapeFiles={AA:"AA",AB:"AB",AD:"AD",AE:"AE",AG:"AG",AP:"AP",BA:"BA",BB:"BB",BC:"BC",BF:"BF",BF0:"BF0",BF4:"BF4",BG:"BG",BH:"BH",BN:"BN",BQ0:"BQ0",BQ1:"BQ1",CF:"CF",CG:"CG",CJ:"CJ",CK:"CK",CM:"CM",CR:"CR",CS:"CS",CT:"CT",CU:"CU",CV:"CV",CW0:"CW0",CW1:"CW1",DF:"CF",DG:"DG",DJ:"CJ",DK:"DK",DM:"DM",DR:"DR",DS:"DS",DT:"DT",DU:"DU",DV:"CV",DW0:"CW0",DW1:"CW1",Z0A:"Z0A",ZAB:"ZAB",ZBC:"ZBC",ZCD:"ZCD",ZD0:"ZD0"};ZUSE.Shapes={paths:{},parsePath:function(b){var c={commands:[]};if("circle"===b.tagName){var d=parseInt(b.getAttribute("cx")),e=parseInt(b.getAttribute("cy")),b=parseInt(b.getAttribute("r"));c.stepSize=10;c.commands.push(["M",d,e]);c.commands.push(["c",b])}else{c.stepSize=parseInt(b.getAttribute("stepSize"));b=b.getAttribute("d").split(" ");for(e=0;e<b.length;e++)if(1===b[e].length)d=b[e];else{var f=b[e].split(",");switch(d){case "M":c.commands.push(["M",parseInt(f[0]),parseInt(f[1])]);break;case "l":c.commands.push(["l",
parseInt(f[0]),parseInt(f[1])]);break;case "a":var g=parseInt(f[5]),h=parseInt(f[6]);0===g||0===h?c.commands.push(["a",g,h]):c.commands.push(["b",g]);break;case "q":var g=parseInt(f[0]),h=parseInt(f[1]),k=parseInt(f[2]),f=parseInt(f[3]);c.commands.push(["q",g,h,k,f])}}}return c},addPath:function(b){for(var c=ZUSE.XMLUtils.loadXML("projects/adder/sheets/"+ZUSE.ShapeFiles[b]+".svg"),d=c.documentElement.firstElementChild.nextElementSibling,e=1;e<d.childNodes.length;e+=2){var f="#"+d.childNodes[e].getAttribute("id");
void 0===this.paths[f]&&(this.paths[f]=this.parsePath(d.childNodes[e]))}e=c.documentElement.lastElementChild;c=this.parsePath(e.firstElementChild);d=e.lastElementChild;c.holes=[];for(e=1;e<d.childNodes.length;e+=2){var f=d.childNodes[e].href.baseVal,g=parseInt(d.childNodes[e].getAttribute("x")),h=parseInt(d.childNodes[e].getAttribute("y"));c.holes.push([f,g,h])}this.paths[b]=c},executeCommands:function(b,c){for(var d=0;d<c.length;d++)switch(c[d][0]){case "M":b.moveBy(c[d][1],c[d][2]);break;case "l":b.stepBy(c[d][1],
c[d][2]);break;case "a":b.arcBy(c[d][1],c[d][2]);break;case "b":b.quarterArc(c[d][1]);break;case "c":b.circle(c[d][1]);break;case "q":b.quadraticCurveBy(c[d][1],c[d][2],c[d][3],c[d][4])}},drawShape:function(b,c,d){var e=new THREE.Shape;e.moveTo(c,d);e.setStepSize(b.stepSize);this.executeCommands(e,b.commands);for(var f=0;f<b.holes.length;f++){var g=new THREE.Path;g.moveTo(c+b.holes[f][1],d+b.holes[f][2]);var h=this.paths[b.holes[f][0]];g.setStepSize(h.stepSize);this.executeCommands(g,h.commands);
e.holes.push(g)}return e},getShape:function(b,c,d){void 0===this.paths[b]&&this.addPath(b);return this.drawShape(this.paths[b],c,d)}};ZUSE.Cyclable=function(b,c,d,e,f){this.name=b;this.x1=c;this.x2=d;this.y1=e;this.y2=f;this.position=0;this.xMove=this.x1<this.x2?!0:!1;this.yMove=this.y1>this.y2?!0:!1};
ZUSE.Cyclable.prototype={constructor:ZUSE.Cyclable,move:function(b,c){switch(b){case 1:this.mesh.position.y=-c;break;case 2:this.mesh.position.x=c;break;case 3:this.mesh.position.y=-10+c;break;case 4:this.mesh.position.x=10-c}},changePosition:function(b){var c=this.position+1;c===b?this.position=c%4:c%4+1===b?this.position=(c+2)%4:console.warn("Unable to change position of "+this.name+".")},changePositionBack:function(b){var c=this.position;c===b%4?this.position=(c+3)%4:c===(b+1)%4?this.position=
(c+1)%4:console.warn("Unable to change position of "+this.name+".")}};ZUSE.Transition=function(b,c,d,e){this.control=b;this.tact=c;this.changesTact=e;this.elements=[];if(void 0!==d)for(b=0;b<d.length;b++)this.elements.push(d[b]);for(b=0;b<this.elements.length;b++)this.trigger(this.elements[b])};
ZUSE.Transition.prototype={constructor:ZUSE.Transition,initPulsers:function(){for(var b=this.control.adder.pulsers,c=0;c<b.length;c++){var d=b[c];if((1===this.tact||3===this.tact)&&d.yMove||(2===this.tact||4===this.tact)&&d.xMove)this.elements.push(d),this.trigger(d)}},trigger:function(b){for(var b=this.control.triggerRules.getTriggerResults(b,this.tact),c=0;c<b.length;c++)-1===this.elements.indexOf(b[c])&&(this.elements.push(b[c]),this.trigger(b[c]))},run:function(b){this.value=0;this.highlight(!0);
var c=(new TWEEN.Tween(this)).to({value:10},1E3);c.onUpdate(function(){for(var b=0;b<this.elements.length;b++)this.elements[b].move(this.tact,this.value)});c.onComplete(function(){for(var c=0;c<this.elements.length;c++)b||this.elements[c].changePosition(this.tact);this.highlight(!1);b||this.writeLog();this.control.isMoving=!1});c.easing(TWEEN.Easing.Quadratic.EaseInOut);c.start()},runBackwards:function(){this.value=10;this.highlight(!0);var b=(new TWEEN.Tween(this)).to({value:0},1E3);b.onUpdate(function(){for(var b=
0;b<this.elements.length;b++)this.elements[b].move(this.tact,this.value)});b.onComplete(function(){for(var b=0;b<this.elements.length;b++)this.elements[b].changePositionBack(this.tact);this.highlight(!1);this.control.isMoving=!1});b.easing(TWEEN.Easing.Quadratic.EaseInOut);b.start()},highlight:function(b){for(var c=0;c<this.elements.length;c++)this.elements[c].setHighlight(b)},writeLog:function(){var b="";switch(this.tact){case 1:b=b+"Eingabe:<br/>&nbsp;&nbsp;A = "+document.getElementById("ButtonA3").value;
b+=document.getElementById("ButtonA2").value;b+=document.getElementById("ButtonA1").value;b+=document.getElementById("ButtonA0").value;b=b+"<br/>&nbsp;&nbsp;B = "+document.getElementById("ButtonB3").value;b+=document.getElementById("ButtonB2").value;b+=document.getElementById("ButtonB1").value;b+=document.getElementById("ButtonB0").value;b+="<br/>";break;case 2:var c=document.getElementById("ButtonF0").value,b=b+("1"===c?"+ \u00dcbertrag F0<br/>":""),c=document.getElementById("ButtonF4").value,b=
b+("1"===c?"\u00dcberlauf!<br/>":"");break;case 3:b=b+"A+B = "+document.getElementById("ButtonK3").value,b+=document.getElementById("ButtonK2").value,b+=document.getElementById("ButtonK1").value,b+=document.getElementById("ButtonK0").value,b+="<br/><br/>"}document.getElementById("log").innerHTML+=b;document.getElementById("log").scrollTop=document.getElementById("log").scrollHeight}};ZUSE.TriggerRules=function(b){this.adder=b;this.init()};
ZUSE.TriggerRules.prototype={constructor:ZUSE.TriggerRules,addTriggerRule:function(b,c,d){void 0===this[b[0]]&&(this[b[0]]={});void 0===this[b[0]][b[1]]&&(this[b[0]][b[1]]=[]);for(var e=0;e<d.length;e++)void 0===this[b[0]][b[1]][d[e]]&&(this[b[0]][b[1]][d[e]]=[]),this[b[0]][b[1]][d[e]].push(c)},addMultipleRules:function(b,c,d,e){this.addTriggerRule([b[0],b[1]+"0"],[c[0],c[1]+"0",c[2]],d,e);this.addTriggerRule([b[0],b[1]+"1"],[c[0],c[1]+"1",c[2]],d,e);this.addTriggerRule([b[0],b[1]+"2"],[c[0],c[1]+
"2",c[2]],d,e);this.addTriggerRule([b[0],b[1]+"3"],[c[0],c[1]+"3",c[2]],d,e)},getTriggerResults:function(b,c){var d=[],e=this.getConditions(b,c);if(void 0!==e)for(var f=0;f<e.length;f++){var g=this.getElement(e[f]);void 0!==g?this.evaluatePosition(g.position,b.position,e[f][2])&&-1===d.indexOf(g)&&d.push(g):console.warn("Looking for undefined Element "+e[f][0]+":"+e[f][1]+".")}return d},getConditions:function(b,c){if(void 0!==this[b.name[0]]&&void 0!==this[b.name[0]][b.name[1]])return this[b.name[0]][b.name[1]][c]},
getElement:function(b){var c=this.adder.layersByType[b[0]];if(void 0!==c)return c.cycleAccess[b[1]]},evaluatePosition:function(b,c,d){if(null!==d){for(var e=0;e<d.length;e++)if(0>d[e]){if(c===-1*d[e])return!0}else if(b===d[e])return!0;return!1}return!0},init:function(){this.addMultipleRules(["In","A"],["0A","A",null],[2,4],!0);this.addMultipleRules(["In","A"],["A","A",null],[2,4],!0);this.addMultipleRules(["In","A"],["AB","A",null],[2,4],!0);this.addMultipleRules(["In","A"],["B","A",null],[2,4],!0);
this.addMultipleRules(["In","A"],["BC","A",null],[2,4],!0);this.addMultipleRules(["In","A"],["C","A",null],[2,4],!0);this.addMultipleRules(["In","A"],["CD","A",null],[2,4],!0);this.addMultipleRules(["In","A"],["D","A",null],[2,4],!0);this.addMultipleRules(["In","A"],["D0","A",null],[2,4],!0);this.addTriggerRule(["0A","X0"],["In","A0",[0]],[2],!1);this.addTriggerRule(["0A","X0"],["In","A1",[0]],[2],!1);this.addTriggerRule(["0A","X0"],["In","A2",[0]],[2],!1);this.addTriggerRule(["0A","X0"],["In","A3",
[0]],[2],!1);this.addMultipleRules(["In","B"],["0A","B",null],[1,3],!0);this.addMultipleRules(["In","B"],["A","B",null],[1,3],!0);this.addMultipleRules(["In","B"],["AB","B",null],[1,3],!0);this.addMultipleRules(["In","B"],["B","B",null],[1,3],!0);this.addMultipleRules(["In","B"],["BC","B",null],[1,3],!0);this.addMultipleRules(["In","B"],["C","B",null],[1,3],!0);this.addMultipleRules(["In","B"],["CD","B",null],[1,3],!0);this.addMultipleRules(["In","B"],["D","B",null],[1,3],!0);this.addMultipleRules(["In",
"B"],["D0","B",null],[1,3],!0);this.addTriggerRule(["0A","Y1"],["In","B0",[1]],[3],!1);this.addTriggerRule(["0A","Y1"],["In","B1",[1]],[3],!1);this.addTriggerRule(["0A","Y1"],["In","B2",[1]],[3],!1);this.addTriggerRule(["0A","Y1"],["In","B3",[1]],[3],!1);this.addMultipleRules(["A","F"],["0A","F",null],[2,4],!0);this.addMultipleRules(["A","F"],["AB","F",null],[2,4],!0);this.addMultipleRules(["A","F"],["B","F",null],[2,4],!0);this.addMultipleRules(["A","F"],["BC","F",null],[2,4],!0);this.addMultipleRules(["A",
"F"],["C","F",null],[2,4],!0);this.addMultipleRules(["A","F"],["CD","F",null],[2,4],!0);this.addMultipleRules(["A","F"],["D","F",null],[2,4],!0);this.addMultipleRules(["A","F"],["D0","F",null],[2,4],!0);this.addMultipleRules(["B","F"],["A","F",null],[2,4],!0);this.addTriggerRule(["A","F4"],["0A","F4",null],[2,4],!0);this.addTriggerRule(["A","F4"],["AB","F4",null],[2,4],!0);this.addTriggerRule(["A","F4"],["B","F4",null],[2,4],!0);this.addTriggerRule(["A","F4"],["BC","F4",null],[2,4],!0);this.addTriggerRule(["A",
"F4"],["C","F4",null],[2,4],!0);this.addTriggerRule(["A","F4"],["CD","F4",null],[2,4],!0);this.addTriggerRule(["A","F4"],["D","F4",null],[2,4],!0);this.addTriggerRule(["A","F4"],["D0","F4",null],[2,4],!0);this.addTriggerRule(["B","F4"],["A","F4",null],[2,4],!0);this.addMultipleRules(["A","J"],["0A","J",null],[2,4],!0);this.addMultipleRules(["A","J"],["AB","J",null],[2,4],!0);this.addMultipleRules(["A","J"],["B","J",null],[2,4],!0);this.addMultipleRules(["A","J"],["BC","J",null],[2,4],!0);this.addMultipleRules(["A",
"J"],["C","J",null],[2,4],!0);this.addMultipleRules(["A","J"],["CD","J",null],[2,4],!0);this.addMultipleRules(["A","J"],["D","J",null],[2,4],!0);this.addMultipleRules(["A","J"],["D0","J",null],[2,4],!0);this.addMultipleRules(["B","J"],["A","J",null],[2,4],!0);this.addTriggerRule(["C","V"],["CD","V",null],[1,3],!0);this.addTriggerRule(["C","V"],["D","V",null],[1,3],!0);this.addTriggerRule(["A","X1"],["A","AP",null],[2,4],!1);this.addMultipleRules(["A","A"],["A","AA",null],[2,4],!1);this.addMultipleRules(["A",
"AA"],["A","D",null],[2,4],!1);this.addMultipleRules(["A","B"],["A","AB",null],[1,3],!1);this.addMultipleRules(["A","AB"],["A","D",[0]],[1],!1);this.addMultipleRules(["A","AB"],["A","D",[2]],[3],!1);this.addMultipleRules(["A","D"],["A","AD",null],[1,3],!1);this.addMultipleRules(["A","AD"],["A","E",null],[1,3],!1);this.addMultipleRules(["A","E"],["A","AE",null],[2,4],!1);this.addMultipleRules(["A","AE"],["A","J",null],[2],!1);this.addTriggerRule(["A","AP"],["A","E0",[1]],[2],!1);this.addTriggerRule(["A",
"AP"],["A","E0",[3]],[4],!1);this.addTriggerRule(["A","AE0"],["A","F1",null],[2],!1);this.addTriggerRule(["A","AP"],["A","E1",[1]],[2],!1);this.addTriggerRule(["A","AP"],["A","E1",[3]],[4],!1);this.addTriggerRule(["A","AE1"],["A","F2",null],[2],!1);this.addTriggerRule(["A","AP"],["A","E2",[1]],[2],!1);this.addTriggerRule(["A","AP"],["A","E2",[3]],[4],!1);this.addTriggerRule(["A","AE2"],["A","F3",null],[2],!1);this.addTriggerRule(["A","AP"],["A","E3",[1]],[2],!1);this.addTriggerRule(["A","AP"],["A",
"E3",[3]],[4],!1);this.addTriggerRule(["A","AE3"],["A","F4",null],[2],!1);this.addTriggerRule(["B","X0"],["B","BQ0",null],[2,4],!1);this.addTriggerRule(["B","Y1"],["B","BQ0",null],[1,3],!1);this.addTriggerRule(["B","X1"],["B","BQ1",null],[2,4],!1);this.addTriggerRule(["B","BQ1"],["B","Q0",null],[2,4],!1);this.addTriggerRule(["B","BQ1"],["B","Q1",null],[2,4],!1);this.addTriggerRule(["B","BQ1"],["B","Q2",null],[2,4],!1);this.addTriggerRule(["B","BQ1"],["B","Q3",null],[2,4],!1);this.addTriggerRule(["B",
"BQ1"],["B","Q4",null],[2,4],!1);this.addTriggerRule(["B","BQ1"],["B","Q5",null],[2,4],!1);this.addTriggerRule(["B","BQ1"],["B","Q6",null],[2,4],!1);this.addTriggerRule(["B","BQ1"],["B","Q7",null],[2,4],!1);this.addTriggerRule(["B","BQ1"],["B","Q8",null],[2,4],!1);this.addTriggerRule(["B","Y3"],["B","BN",null],[1,3],!1);this.addTriggerRule(["In","F0"],["B","BF0",null],[2,4],!0);this.addTriggerRule(["B","X0"],["In","F0",[3]],[4],!1);this.addTriggerRule(["B","BF4"],["In","F4",null],[2,4],!0);this.addMultipleRules(["B",
"A"],["B","BA",null],[2,4],!1);this.addMultipleRules(["B","BA"],["B","C",null],[2,4],!1);this.addMultipleRules(["B","B"],["B","BB",null],[1,3],!1);this.addMultipleRules(["B","Q"],["B","BB",null],[2,4],!1);this.addMultipleRules(["B","BB"],["B","C",[0,3]],[1],!1);this.addMultipleRules(["B","C"],["B","BC",null],[1,3],!1);this.addMultipleRules(["B","BC"],["B","G",null],[1,3],!1);this.addMultipleRules(["B","BC"],["B","H",null],[1,3],!1);this.addMultipleRules(["B","H"],["B","BH",null],[2,4],!1);this.addMultipleRules(["B",
"BH"],["B","J",null],[2,4],!1);this.addMultipleRules(["B","J"],["B","BH",null],[2],!1);this.addMultipleRules(["B","BH"],["B","H",null],[2],!1);this.addMultipleRules(["B","BF"],["B","F",null],[2],!1);this.addMultipleRules(["B","F"],["B","BF",null],[2],!1);this.addTriggerRule(["B","F4"],["B","BF4",null],[2],!1);this.addMultipleRules(["B","F"],["B","BF",[3]],[4],!1);this.addMultipleRules(["B","BF"],["B","G",[1]],[2],!1);this.addTriggerRule(["B","BN"],["B","C0",[0]],[1],!1);this.addTriggerRule(["B","BN"],
["B","C0",[2]],[3],!1);this.addTriggerRule(["B","BQ0"],["B","H0",[0]],[2],!1);this.addTriggerRule(["B","BQ0"],["B","H0",[3]],[4],!1);this.addTriggerRule(["B","BN"],["B","C1",[0]],[1],!1);this.addTriggerRule(["B","BN"],["B","C1",[2]],[3],!1);this.addTriggerRule(["B","BQ0"],["B","H1",[0]],[2],!1);this.addTriggerRule(["B","BQ0"],["B","H1",[3]],[4],!1);this.addTriggerRule(["B","BN"],["B","C2",[0]],[1],!1);this.addTriggerRule(["B","BN"],["B","C2",[2]],[3],!1);this.addTriggerRule(["B","BQ0"],["B","H2",
[0]],[2],!1);this.addTriggerRule(["B","BQ0"],["B","H2",[3]],[4],!1);this.addTriggerRule(["B","BN"],["B","C3",[0]],[1],!1);this.addTriggerRule(["B","BN"],["B","C3",[2]],[3],!1);this.addTriggerRule(["B","BQ0"],["B","H3",[0]],[2],!1);this.addTriggerRule(["B","BQ0"],["B","H3",[3]],[4],!1);this.addTriggerRule(["B","G0"],["B","BF1",null],[2],!1);this.addTriggerRule(["B","G1"],["B","BF2",null],[2],!1);this.addTriggerRule(["B","G2"],["B","BF3",null],[2],!1);this.addTriggerRule(["B","G3"],["B","BF4",null],
[2],!1);this.addTriggerRule(["B","BF1"],["B","G0",[3]],[4],!1);this.addTriggerRule(["B","BF2"],["B","G1",[3]],[4],!1);this.addTriggerRule(["B","BF3"],["B","G2",[3]],[4],!1);this.addTriggerRule(["B","BF4"],["B","G3",[3]],[4],!1);this.addTriggerRule(["B","BF4"],["B","F4",null],[2],!1);this.addTriggerRule(["B","F4"],["B","BF4",[3]],[4],!1);this.addTriggerRule(["C","Y0"],["C","CR",null],[1,3],!1);this.addTriggerRule(["C","Y0"],["C","CU",null],[1,3],!1);this.addTriggerRule(["C","X0"],["C","CS",null],[2,
4],!1);this.addTriggerRule(["C","CS"],["C","S0",null],[2,4],!1);this.addTriggerRule(["C","CS"],["C","S1",null],[2,4],!1);this.addTriggerRule(["C","CS"],["C","S2",null],[2,4],!1);this.addTriggerRule(["C","CS"],["C","S3",null],[2,4],!1);this.addTriggerRule(["C","Y0"],["C","V",[1]],[3],!1);this.addTriggerRule(["C","F0"],["C","CF0",null],[2,4],!1);this.addTriggerRule(["C","CF0"],["C","K0",null],[2,4],!1);this.addTriggerRule(["C","J0"],["C","CJ0",null],[2,4],!1);this.addTriggerRule(["C","CJ0"],["C","W0",
null],[2,4],!1);this.addTriggerRule(["C","CR"],["C","W0",null],[1,3],!1);this.addTriggerRule(["C","W0"],["C","CW00",[-2]],[3],!1);this.addTriggerRule(["C","W0"],["C","CW00",[0]],[1],!1);this.addTriggerRule(["C","W0"],["C","CW10",[-1]],[3],!1);this.addTriggerRule(["C","W0"],["C","CW10",[0]],[1],!1);this.addTriggerRule(["C","CW00"],["C","K0",[2]],[3],!1);this.addTriggerRule(["C","CW10"],["C","K0",[1]],[3],!1);this.addTriggerRule(["C","K0"],["C","CK0",null],[3],!1);this.addTriggerRule(["C","CK0"],["C",
"M0",null],[3],!1);this.addTriggerRule(["C","CK0"],["In","K0",null],[1,3],!0);this.addTriggerRule(["C","CU"],["C","M0",[0,3]],[1],!1);this.addTriggerRule(["C","M0"],["C","CK0",null],[1],!1);this.addTriggerRule(["C","CK0"],["C","K0",null],[1],!1);this.addTriggerRule(["C","S1"],["C","CW10",null],[2,4],!1);this.addTriggerRule(["C","B0"],["C","CM0",null],[1,3],!1);this.addTriggerRule(["C","F2"],["C","CF2",null],[2,4],!1);this.addTriggerRule(["C","CF2"],["C","K2",null],[2,4],!1);this.addTriggerRule(["C",
"J2"],["C","CJ2",null],[2,4],!1);this.addTriggerRule(["C","CJ2"],["C","W2",null],[2,4],!1);this.addTriggerRule(["C","CR"],["C","W2",null],[1,3],!1);this.addTriggerRule(["C","W2"],["C","CW02",[-2]],[3],!1);this.addTriggerRule(["C","W2"],["C","CW02",[0]],[1],!1);this.addTriggerRule(["C","W2"],["C","CW12",[-1]],[3],!1);this.addTriggerRule(["C","W2"],["C","CW12",[0]],[1],!1);this.addTriggerRule(["C","CW02"],["C","K2",[2]],[3],!1);this.addTriggerRule(["C","CW12"],["C","K2",[1]],[3],!1);this.addTriggerRule(["C",
"K2"],["C","CK2",null],[3],!1);this.addTriggerRule(["C","CK2"],["C","M2",null],[3],!1);this.addTriggerRule(["C","CK2"],["In","K2",null],[1,3],!0);this.addTriggerRule(["C","CU"],["C","M2",[0,3]],[1],!1);this.addTriggerRule(["C","M2"],["C","CK2",null],[1],!1);this.addTriggerRule(["C","CK2"],["C","K2",null],[1],!1);this.addTriggerRule(["C","S0"],["C","CW12",null],[2,4],!1);this.addTriggerRule(["C","B2"],["C","CM2",null],[1,3],!1);this.addTriggerRule(["C","CU"],["C","T",[0]],[1],!1);this.addTriggerRule(["C",
"CS"],["C","T",[0,1]],[2],!1);this.addTriggerRule(["C","CS"],["C","T",[2]],[4],!1);this.addTriggerRule(["C","T"],["C","CV",null],[1,3],!1);this.addTriggerRule(["C","T"],["C","CT",null],[2,4],!1);this.addTriggerRule(["C","CV"],["C","V",null],[1,3],!1);this.addTriggerRule(["C","CT"],["C","M0",null],[2,4],!1);this.addTriggerRule(["C","CT"],["C","M2",null],[2,4],!1);this.addTriggerRule(["C","V"],["C","CV",null],[1,3],!1);this.addTriggerRule(["C","CV"],["C","T",null],[1,3],!1);this.addTriggerRule(["D",
"Y0"],["D","DR",null],[1,3],!1);this.addTriggerRule(["D","Y0"],["D","DU",null],[1,3],!1);this.addTriggerRule(["D","X0"],["D","DS",null],[2,4],!1);this.addTriggerRule(["D","DS"],["D","S0",null],[2,4],!1);this.addTriggerRule(["D","DS"],["D","S1",null],[2,4],!1);this.addTriggerRule(["D","DS"],["D","S2",null],[2,4],!1);this.addTriggerRule(["D","DS"],["D","S3",null],[2,4],!1);this.addTriggerRule(["D","F1"],["D","DF1",null],[2,4],!1);this.addTriggerRule(["D","DF1"],["D","K1",null],[2,4],!1);this.addTriggerRule(["D",
"J1"],["D","DJ1",null],[2,4],!1);this.addTriggerRule(["D","DJ1"],["D","W1",null],[2,4],!1);this.addTriggerRule(["D","DR"],["D","W1",null],[1,3],!1);this.addTriggerRule(["D","W1"],["D","DW01",[-2]],[3],!1);this.addTriggerRule(["D","W1"],["D","DW01",[0]],[1],!1);this.addTriggerRule(["D","W1"],["D","DW11",[-1]],[3],!1);this.addTriggerRule(["D","W1"],["D","DW11",[0]],[1],!1);this.addTriggerRule(["D","DW01"],["D","K1",[2]],[3],!1);this.addTriggerRule(["D","DW11"],["D","K1",[1]],[3],!1);this.addTriggerRule(["D",
"K1"],["D","DK1",null],[3],!1);this.addTriggerRule(["D","DK1"],["D","M1",null],[3],!1);this.addTriggerRule(["D","DK1"],["In","K1",null],[1,3],!0);this.addTriggerRule(["D","DU"],["D","M1",[0,3]],[1],!1);this.addTriggerRule(["D","M1"],["D","DK1",null],[1],!1);this.addTriggerRule(["D","DK1"],["D","K1",null],[1],!1);this.addTriggerRule(["D","S1"],["D","DW11",null],[2,4],!1);this.addTriggerRule(["D","B1"],["D","DM1",null],[1,3],!1);this.addTriggerRule(["D","F3"],["D","DF3",null],[2,4],!1);this.addTriggerRule(["D",
"DF3"],["D","K3",null],[2,4],!1);this.addTriggerRule(["D","J3"],["D","DJ3",null],[2,4],!1);this.addTriggerRule(["D","DJ3"],["D","W3",null],[2,4],!1);this.addTriggerRule(["D","DR"],["D","W3",null],[1,3],!1);this.addTriggerRule(["D","W3"],["D","DW03",[-2]],[3],!1);this.addTriggerRule(["D","W3"],["D","DW03",[0]],[1],!1);this.addTriggerRule(["D","W3"],["D","DW13",[-1]],[3],!1);this.addTriggerRule(["D","W3"],["D","DW13",[0]],[1],!1);this.addTriggerRule(["D","DW03"],["D","K3",[2]],[3],!1);this.addTriggerRule(["D",
"DW13"],["D","K3",[1]],[3],!1);this.addTriggerRule(["D","K3"],["D","DK3",null],[3],!1);this.addTriggerRule(["D","DK3"],["D","M3",null],[3],!1);this.addTriggerRule(["D","DK3"],["In","K3",null],[1,3],!0);this.addTriggerRule(["D","DU"],["D","M3",[0,3]],[1],!1);this.addTriggerRule(["D","M3"],["D","DK3",null],[1],!1);this.addTriggerRule(["D","DK3"],["D","K3",null],[1],!1);this.addTriggerRule(["D","S0"],["D","DW13",null],[2,4],!1);this.addTriggerRule(["D","B3"],["D","DM3",null],[1,3],!1);this.addTriggerRule(["D",
"DU"],["D","T",[0]],[1],!1);this.addTriggerRule(["D","DS"],["D","T",[0,1]],[2],!1);this.addTriggerRule(["D","DS"],["D","T",[2]],[4],!1);this.addTriggerRule(["D","T"],["D","DV",null],[1,3],!1);this.addTriggerRule(["D","T"],["D","DT",null],[2,4],!1);this.addTriggerRule(["D","DV"],["D","V",null],[1,3],!1);this.addTriggerRule(["D","DT"],["D","M1",null],[2,4],!1);this.addTriggerRule(["D","DT"],["D","M3",null],[2,4],!1);this.addTriggerRule(["D","V"],["D","DV",null],[1,3],!1);this.addTriggerRule(["D","DV"],
["D","T",null],[1,3],!1);this.addTriggerRule(["A","X0"],["A","F0",[3]],[4],!1);this.addTriggerRule(["A","X0"],["A","F1",[3]],[4],!1);this.addTriggerRule(["A","X0"],["A","F2",[3]],[4],!1);this.addTriggerRule(["A","X0"],["A","F3",[3]],[4],!1);this.addTriggerRule(["A","X0"],["A","F4",[3]],[4],!1)}};ZUSE.CycleControl=function(b){this.adder=b;this.tact=0;this.isMoving=!1;this.history=[];this.nextInputs=[];this.preHighlighted=void 0;this.highlightMoving=!0;this.triggerRules=new ZUSE.TriggerRules(b)};
ZUSE.CycleControl.prototype={constructor:ZUSE.CycleControl,preHighlightNext:function(){this.isMoving||(this.preHighlighted=new ZUSE.Transition(this,this.tact%4+1,this.nextInputs,!0),this.preHighlighted.initPulsers(),this.preHighlighted.highlight(!0))},preHighlightBack:function(){!this.isMoving&&1<=this.history.length&&(this.preHighlighted=this.history[this.history.length-1],this.preHighlighted.highlight(!0))},preHighlightOff:function(){void 0!==this.preHighlighted&&this.preHighlighted.highlight(!1)},
cycle:function(){if(!this.isMoving){this.isMoving=!0;this.tact=this.tact%4+1;var b=new ZUSE.Transition(this,this.tact,this.nextInputs,!0);b.initPulsers();this.history.push(b);this.nextInputs=[];b.run(!1);this.adder.layersByType.In.updateButtonState(this.tact)}},cycleBackwards:function(){if(!this.isMoving&&1<=this.history.length){this.isMoving=!0;var b=this.history.pop();this.nextInputs=[];b.runBackwards();b.changesTact&&(this.tact=(this.tact+2)%4+1);this.adder.layersByType.In.updateButtonState(this.tact)}},
repeatLast:function(){!this.isMoving&&1<=this.history.length&&(this.isMoving=!0,this.history[this.history.length-1].run(!0))},switchInput:function(b,c){if(!this.isMoving)if(0===this.tact||4===this.tact)switch(b){case "A0":case "A1":case "A2":case "A3":this.isMoving=!0;var d=this.adder.layersByType.In.cycleAccess[b],e=0===d.position?2:4;c.target.value="0"===c.target.value?"1":"0";d=new ZUSE.Transition(this,e,[d],!1);this.history.push(d);d.run();break;case "B0":case "B1":case "B2":case "B3":d=this.adder.layersByType.In.cycleAccess[b],
e=this.nextInputs.indexOf(d),-1===e?(this.nextInputs.push(d),c.target.value="1"):(this.nextInputs.splice(e,1),c.target.value="0")}else if(1===this.tact)switch(b){case "F0":d=this.adder.layersByType.In.cycleAccess[b],e=this.nextInputs.indexOf(d),-1===e?(this.nextInputs.push(d),c.target.value="1"):(this.nextInputs.splice(e,1),c.target.value="0")}}};ZUSE.Shader={vertexShader:"uniform  vec3 color;\nuniform float transparency;\nuniform float clippingX1;\nuniform float clippingX2;\nuniform float clippingY1;\nuniform float clippingY2;\nuniform float clippingTransparency;\nuniform float fadingWidth;\nvarying vec3 pixelCoordinates;\nvarying vec3 pixelNormal;\nvoid main() {\npixelCoordinates = position;\npixelNormal = normal;\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n}",fragmentShader:"uniform  vec3 color;\nuniform float transparency;\nuniform float clippingX1;\nuniform float clippingX2;\nuniform float clippingY1;\nuniform float clippingY2;\nuniform float clippingTransparency;\nuniform float fadingWidth;\nvarying vec3 pixelCoordinates;\nvarying vec3 pixelNormal;\nvoid main( void ) {\nif ( transparency < 0.01 ) {\ndiscard;\n} else {\nfloat shade = (\t3.0 * pow ( abs ( pixelNormal.z ), 2.0 ) + \t\t\t\t\t\t\t\t\t2.0 * pow ( abs ( pixelNormal.y ), 2.0 ) + \t\t\t\t\t\t\t\t\t1.0 * pow ( abs ( pixelNormal.x ), 2.0 ) ) / 3.0;\nif ( clippingTransparency >= transparency ) {\ngl_FragColor = vec4( color * shade, transparency );\n} else if (    ( pixelCoordinates.x + 0.01 ) >= clippingX1 && \t\t\t\t\t\t\t\t( pixelCoordinates.x - 0.01 ) <= clippingX2 && \t\t\t\t\t\t\t\t( pixelCoordinates.y + 0.01 ) >= clippingY1 && \t\t\t\t\t\t\t\t( pixelCoordinates.y - 0.01 ) <= clippingY2 ) {\ngl_FragColor = vec4( color * shade, transparency );\n} else if ( fadingWidth < 0.01 ) {\nif ( clippingTransparency < 0.01 ) {\ndiscard;\n} else {\ngl_FragColor = vec4( color * shade, clippingTransparency );\n}\n} else {\nfloat fadingX = min( \t\t\t\t\t\tmax( 1.0 - ( clippingX1 - pixelCoordinates.x ) / fadingWidth, 0.0 ), \t\t\t\t\t\tmax( 1.0 - ( pixelCoordinates.x - clippingX2 ) / fadingWidth, 0.0 ) );\nfloat fadingY = min( \t\t\t\t\t\tmax( 1.0 - ( clippingY1 - pixelCoordinates.y ) / fadingWidth, 0.0 ), \t\t\t\t\t\tmax( 1.0 - ( pixelCoordinates.y - clippingY2 ) / fadingWidth, 0.0 ) );\nfloat fadingTransparency = min( fadingX, fadingY ) * \t\t\t\t\t\t\t\t\t\t\t\t( transparency - clippingTransparency ) + \t\t\t\t\t\t\t\t\t\t\t\tclippingTransparency;\nif ( fadingTransparency < 0.01 ) {\ndiscard;\n} else {\ngl_FragColor = vec4( color * shade, fadingTransparency );\n}\n}\n}\n}"};ZUSE.Colors={SheetBlue:new THREE.Color(10066431),InterBlue:new THREE.Color(6710988),PinBlue:new THREE.Color(3355545),UglyGreen:new THREE.Color(6723891),MugYellow:new THREE.Color(13421619),PrettyPink:new THREE.Color(16737996),BlackBlood:new THREE.Color(6697779),Turquoise:new THREE.Color(6723993),Highlight:new THREE.Color(16724736),Gray:new THREE.Color(14737632),NewBlue1:new THREE.Color(4038347),NewBlue2:new THREE.Color(3310505),NewBlue3:new THREE.Color(1269372),NewBlue4:new THREE.Color(10734816)};ZUSE.ShaderUniforms={x1:{type:"f",value:0},x2:{type:"f",value:0},y1:{type:"f",value:0},y2:{type:"f",value:0},clippingTransparency:{type:"f",value:0},fadingWidth:{type:"f",value:0}};ZUSE.Material=function(b,c){this.color={type:"c",value:b};this.transparency={type:"f",value:c};this.shader=new THREE.ShaderMaterial({uniforms:{color:this.color,transparency:this.transparency,clippingX1:ZUSE.ShaderUniforms.x1,clippingX2:ZUSE.ShaderUniforms.x2,clippingY1:ZUSE.ShaderUniforms.y1,clippingY2:ZUSE.ShaderUniforms.y2,clippingTransparency:ZUSE.ShaderUniforms.clippingTransparency,fadingWidth:ZUSE.ShaderUniforms.fadingWidth},vertexShader:ZUSE.Shader.vertexShader,fragmentShader:ZUSE.Shader.fragmentShader,
transparent:!0})};ZUSE.Materials={MovingSheet:new ZUSE.Material(ZUSE.Colors.NewBlue1,1),StaticSheet:new ZUSE.Material(ZUSE.Colors.NewBlue2,1),IntermediateSheet:new ZUSE.Material(ZUSE.Colors.NewBlue3,1),MovingPin:new ZUSE.Material(ZUSE.Colors.NewBlue4,1),StaticPin:new ZUSE.Material(ZUSE.Colors.NewBlue4,1),Highlight:new ZUSE.Material(ZUSE.Colors.Highlight,1),BoxBackFace:new THREE.MeshBasicMaterial({color:15654348,transparent:!0}),BoxWireframe:new THREE.MeshBasicMaterial({color:0,transparent:!0,wireframe:!0,wireframeLinewidth:2}),
BoxWireActive:new THREE.MeshBasicMaterial({color:16724736,transparent:!0,wireframe:!0,wireframeLinewidth:4})};ZUSE.Sheet=function(b,c,d,e,f,g,h,k,i,j){ZUSE.Cyclable.call(this,b,d,e,f,g);this.level=h;this.thickness=(this.intermediate=i)?10:3;this.moving=j;b={amount:this.thickness,bevelEnabled:!1,steps:1};c=ZUSE.Shapes.getShape(c,d,f).extrude(b);i=j?ZUSE.Materials.MovingSheet.shader:i?ZUSE.Materials.IntermediateSheet.shader:ZUSE.Materials.StaticSheet.shader;this.mesh=new THREE.Mesh(c,i);this.mesh.defaultMaterial=i;this.setHeight(h*k)};ZUSE.Sheet.prototype=new ZUSE.Cyclable;
ZUSE.Sheet.prototype.constructor=ZUSE.Sheet;ZUSE.Sheet.prototype.setHeight=function(b){this.mesh.position.z=b-this.thickness/2};ZUSE.Sheet.prototype.setHighlight=function(b){this.mesh.material=b&&ZUSE.adderObj.cycleControl.highlightMoving?ZUSE.Materials.Highlight.shader:this.mesh.defaultMaterial};ZUSE.Pin=function(b,c,d,e,f,g,h,k,i,j){ZUSE.Cyclable.call(this,b,c,d,e,f);this.l1=g;this.l2=h;this.moving=j;b=new THREE.Shape;b.moveTo(c,e);switch(i){case 4:b.moveBy(5,5);b.circle(4);break;case 6:b.moveBy(10,10),b.circle(6)}c=b.extrude({amount:1,bevelEnabled:!1,steps:1});j=j?ZUSE.Materials.MovingPin.shader:ZUSE.Materials.StaticPin.shader;this.mesh=new THREE.Mesh(c,j);this.mesh.defaultMaterial=j;this.setHeight(g*k,h*k)};ZUSE.Pin.prototype=new ZUSE.Cyclable;ZUSE.Pin.prototype.constructor=ZUSE.Pin;
ZUSE.Pin.prototype.setHeight=function(b,c){this.mesh.position.z=b;this.mesh.scale.z=c-b};ZUSE.Pin.prototype.setHighlight=function(b){this.mesh.material=b&&ZUSE.adderObj.cycleControl.highlightMoving?ZUSE.Materials.Highlight.shader:this.mesh.defaultMaterial};ZUSE.PlaneGeometry=function(b,c,d,e){THREE.Geometry.call(this);this.vertices.push(b,c,d,e);this.faces.push(new THREE.Face4(0,1,2,3));this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};ZUSE.PlaneGeometry.prototype=new THREE.Geometry;ZUSE.PlaneGeometry.prototype.constructor=ZUSE.PlaneGeometry;ZUSE.Axis=function(b,c){this.a=b;this.d=c;this.toString=function(){return this.a+this.d}};ZUSE.Selection=function(b,c){this.parent=c;this.limits=b;this.limits.z1=-10;this.limits.z2=this.getHeight()+10;this.initShaderUniforms();this.oldValue=0;this.values={x1:this.limits.x1,x2:this.limits.x2,y1:this.limits.y1,y2:this.limits.y2,z1:this.limits.z1,z2:this.limits.z2};this.visibleLayers={z1:0,z2:8};this.vertices=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.updateVertices();this.meshes=new THREE.Object3D;
this.geometries=[];this.addFace({a:"y",d:1},0,1,5,4);this.addFace({a:"z",d:1},0,2,3,1);this.addFace({a:"x",d:1},0,4,6,2);this.addFace({a:"x",d:2},7,5,1,3);this.addFace({a:"y",d:2},7,3,2,6);this.addFace({a:"z",d:2},7,6,4,5);this.enabled=!1;this.setActivation(!1)};
ZUSE.Selection.prototype={constructor:ZUSE.Selection,initShaderUniforms:function(){ZUSE.ShaderUniforms.x1.value=this.limits.x1;ZUSE.ShaderUniforms.x2.value=this.limits.x2;ZUSE.ShaderUniforms.y1.value=this.limits.y1;ZUSE.ShaderUniforms.y2.value=this.limits.y2},addFace:function(b,c,d,e,f){b.toString=function(){return this.a+this.d};var g=new ZUSE.PlaneGeometry(this.vertices[c],this.vertices[d],this.vertices[e],this.vertices[f]);g.dynamic=!0;this.geometries.push(g);g=new THREE.Mesh(g,ZUSE.Materials.BoxWireframe);
g.axis=b;this.meshes.add(g);this.parent.selectables.push(g);b=new ZUSE.PlaneGeometry(this.vertices[f],this.vertices[e],this.vertices[d],this.vertices[c]);b.dynamic=!0;this.geometries.push(b);b=new THREE.Mesh(b,ZUSE.Materials.BoxBackFace);this.meshes.add(b)},setBoxValue:function(b,c){this.values[b]=c;this.updateVertices();this.updateGeometries()},setDisplayValue:function(b,c){switch(b.a){case "x":case "y":ZUSE.ShaderUniforms[b].value=c;break;case "z":this.setVisibleLayers(b,c,!1);break;default:console.warn("axis "+
b.a+" invalid")}},setDisplayValuesAnimated:function(b){this.time=0;var c=ZUSE.ShaderUniforms.x1.value,d=ZUSE.ShaderUniforms.x2.value,e=ZUSE.ShaderUniforms.y1.value,f=ZUSE.ShaderUniforms.y2.value,g=(new TWEEN.Tween(this)).to({time:1},1E3);g.onUpdate(function(){ZUSE.ShaderUniforms.x1.value=c+this.time*(b.x1-c);ZUSE.ShaderUniforms.x2.value=d+this.time*(b.x2-d);ZUSE.ShaderUniforms.y1.value=e+this.time*(b.y1-e);ZUSE.ShaderUniforms.y2.value=f+this.time*(b.y2-f)});g.onComplete(function(){this.setVisibleLayers(new ZUSE.Axis("z",
1),b.z1,!1);this.setVisibleLayers(new ZUSE.Axis("z",2),b.z2,!1)});g.easing(TWEEN.Easing.Quadratic.EaseInOut);g.start();this.setVisibleLayers(new ZUSE.Axis("z",1),b.z1,!0);this.setVisibleLayers(new ZUSE.Axis("z",2),b.z2,!0)},setVisibleLayers:function(b,c,d){if(this.visibleLayers[b]!==c&&(!d||!(1===b.d&&c>this.visibleLayers[b]||2===b.d&&c<this.visibleLayers[b]))){this.visibleLayers[b]=c;for(b=0;b<this.parent.layers.length;b++)this.parent.layers[b].setVisibility(b>=this.visibleLayers.z1&&b<=this.visibleLayers.z2)}},
conformRange:function(b,c){var d="z"===b.a?40:20;switch(b.d){case 1:c=Math.max(c,this.limits[b]);c=Math.min(c,this.values[b.a+2]-d);break;case 2:c=Math.max(c,this.values[b.a+1]+d);c=Math.min(c,this.limits[b]);break;default:console.warn("axis direction "+b.d+" invalid")}return c},conformLayerRange:function(b,c){if("z"===b.a)switch(b.d){case 1:c=Math.max(c,0);c=Math.min(c,this.visibleLayers.z2);break;case 2:c=Math.max(c,this.visibleLayers.z1);c=Math.min(c,8);break;default:console.warn("axis direction "+
b.d+" invalid")}else c=this.conformRange(b,c);return c},computeLayerFromBox:function(b,c){if("z"===b.a){for(var d=0,e=0,f=0;f<this.parent.layers.length;f++)1===b.d&&c>d&&(e=f+1),d+=this.parent.layers[f].getHeight(),2===b.d&&c>=d&&(e=f);c=e}return c},computeBoxFromLayer:function(b,c){"z"===b.a&&(n=c,c=this.parent.layers[n].meshes.position.z,c+=2===b.d?this.parent.layers[n].getHeight():0);return c},updateVertices:function(){this.vertices[0].set(this.values.x1,this.values.y1,this.values.z1);this.vertices[1].set(this.values.x2,
this.values.y1,this.values.z1);this.vertices[2].set(this.values.x1,this.values.y2,this.values.z1);this.vertices[3].set(this.values.x2,this.values.y2,this.values.z1);this.vertices[4].set(this.values.x1,this.values.y1,this.values.z2);this.vertices[5].set(this.values.x2,this.values.y1,this.values.z2);this.vertices[6].set(this.values.x1,this.values.y2,this.values.z2);this.vertices[7].set(this.values.x2,this.values.y2,this.values.z2)},updateGeometries:function(){for(var b=0;b<this.geometries.length;b++)this.geometries[b].computeCentroids(),
this.geometries[b].verticesNeedUpdate=!0},getHeight:function(){var b=this.parent.layers[this.parent.layers.length-1];return b.meshes.position.z+b.getHeight()},updateHeightLimit:function(){this.limits.z2=this.getHeight()+10},updateBoxHeight:function(){var b={a:"z",d:1,toString:function(){return this.a+this.d}},c={a:"z",d:2,toString:function(){return this.a+this.d}},d=this.computeBoxFromLayer(b,this.visibleLayers.z1),e=this.computeBoxFromLayer(c,this.visibleLayers.z2);this.setBoxValue(b,d);this.setBoxValue(c,
e)},dragStart:function(b){this.oldValue=this.values[b]},setFromMouse:function(b,c,d){c+=d?this.oldValue:0;c=this.conformRange(b,c);this.setBoxValue(b,c);c=this.computeLayerFromBox(b,c);c=this.conformLayerRange(b,c);this.setDisplayValue(b,c);this.setSlider(b,c)},setFromSlider:function(b,c,d){this.setOneFromSlider(new ZUSE.Axis(b,1),this.transformValueFromSlider(b,c),!1);this.setOneFromSlider(new ZUSE.Axis(b,2),this.transformValueFromSlider(b,d),!1)},setOneFromSlider:function(b,c,d){c=this.conformLayerRange(b,
c);this.setDisplayValue(b,c);d&&this.setSlider(b,c);c=this.computeBoxFromLayer(b,c);c=this.conformRange(b,c);this.setBoxValue(b,c)},setFromCircuit:function(b){this.setDisplayValuesAnimated(b);this.setOneFromCircuit(new ZUSE.Axis("x",1),b.x1,!0);this.setOneFromCircuit(new ZUSE.Axis("x",2),b.x2,!0);this.setOneFromCircuit(new ZUSE.Axis("y",1),b.y1,!0);this.setOneFromCircuit(new ZUSE.Axis("y",2),b.y2,!0);this.setOneFromCircuit(new ZUSE.Axis("z",1),b.z1,!0);this.setOneFromCircuit(new ZUSE.Axis("z",2),
b.z2,!0)},setOneFromCircuit:function(b,c,d){d&&this.setSlider(b,c);c=this.computeBoxFromLayer(b,c);this.setBoxValue(b,c)},setSlider:function(b,c){var d;switch(b.a){case "x":d="#sliderX";break;case "y":d="#sliderY";break;case "z":d="#sliderZ";break;default:console.warn("axis "+b.a+" invalid")}c=this.transformValueToSlider(b.a,c);$(d).slider("values",b.d-1,c)},transformValueFromSlider:function(b,c){"z"!==b&&(c=c/1E3*(this.limits[b+2]-this.limits[b+1])+this.limits[b+1]);return c},transformValueToSlider:function(b,
c){"z"!==b&&(c=1E3*((c-this.limits[b+1])/(this.limits[b+2]-this.limits[b+1])));return c},reset:function(){this.setFromCircuit({x1:this.limits.x1,x2:this.limits.x2,y1:this.limits.y1,y2:this.limits.y2,z1:0,z2:8});ZUSE.SVGUtils.reset()},setActivation:function(b){this.enabled=b;for(var c=0;c<this.meshes.children.length;c++)this.meshes.children[c].visible=b,2<=this.meshes.children[c].children.length&&(this.meshes.children[c].children[0].visible=b,this.meshes.children[c].children[1].visible=b);b||(document.body.style.cursor=
"auto")}};ZUSE.InputElement=function(b,c,d){this.name=b;this.values=c;this.activeTact=d;this.position=0};
ZUSE.InputElement.prototype={constructor:ZUSE.InputElement,move:function(){},setHighlight:function(){},changePosition:function(b){var c=this.position+1;c===b?this.position=c%4:c%4+1===b?this.position=(c+2)%4:console.warn("Unable to change position of"+this.name+".");document.getElementById("Button"+this.name[1]).value=this.values[this.position]},changePositionBack:function(b){var c=this.position;c===b%4?this.position=(c+3)%4:c===(b+1)%4?this.position=(c+1)%4:console.warn("Unable to change position of "+
this.name+".");document.getElementById("Button"+this.name[1]).value=this.values[this.position]},updateButtonState:function(b){document.getElementById("Button"+this.name[1]).disabled=this.evaluateState(b)},evaluateState:function(b){return null!==this.activeTact?b===this.activeTact?!1:!0:!0}};ZUSE.InputControlLayer=function(){this.cycleAccess={};this.addInput(["In","A0"],["1","?","?","0"],4);this.addInput(["In","A1"],["1","?","?","0"],4);this.addInput(["In","A2"],["1","?","?","0"],4);this.addInput(["In","A3"],["1","?","?","0"],4);this.addInput(["In","B0"],["0","1","?","?"],4);this.addInput(["In","B1"],["0","1","?","?"],4);this.addInput(["In","B2"],["0","1","?","?"],4);this.addInput(["In","B3"],["0","1","?","?"],4);this.addInput(["In","F0"],["0","?","?","1"],1);this.addInput(["In","K0"],
["1","0","?","?"],null);this.addInput(["In","K1"],["1","0","?","?"],null);this.addInput(["In","K2"],["1","0","?","?"],null);this.addInput(["In","K3"],["1","0","?","?"],null);this.addInput(["In","F4"],["0","?","?","1"],null)};ZUSE.InputControlLayer.prototype={constructor:ZUSE.InputControlLayer,addInput:function(b,c,d){this.cycleAccess[b[1]]=new ZUSE.InputElement(b,c,d)},updateButtonState:function(b){for(a in this.cycleAccess)this.cycleAccess[a].updateButtonState(b)}};ZUSE.LayerTypes={LAYER_A:"A",LAYER_B:"B",LAYER_C:"C",LAYER_D:"D",LAYER_0A:"0A",LAYER_AB:"AB",LAYER_BC:"BC",LAYER_CD:"CD",LAYER_D0:"D0"};ZUSE.Layer=function(b,c,d){this.type=b;this.parent=d;this.spacing=c;this.intermediate=this.open=!1;this.meshes=new THREE.Object3D;this.sheets=[];this.pins=[];this.cycleAccess={};switch(b){case ZUSE.LayerTypes.LAYER_A:this.levels=7;this.addSheet(ZUSE.SheetTypes.SHEET_AG,0,0,0,70,70,0);this.addSheet(ZUSE.SheetTypes.SHEET_AD,3,74,74,76,66,1);this.addSheet(ZUSE.SheetTypes.SHEET_AD,2,114,114,76,66,1);this.addSheet(ZUSE.SheetTypes.SHEET_AD,1,154,154,76,66,1);this.addSheet(ZUSE.SheetTypes.SHEET_AD,0,194,
194,76,66,1);this.addSheet(ZUSE.SheetTypes.SHEET_AE,3,11,21,50,50,2);this.addSheet(ZUSE.SheetTypes.SHEET_AE,0,131,141,50,50,2);this.addSheet(ZUSE.SheetTypes.SHEET_AB,3,74,74,135,125,2);this.addSheet(ZUSE.SheetTypes.SHEET_AB,2,114,114,135,125,2);this.addSheet(ZUSE.SheetTypes.SHEET_AB,1,154,154,135,125,2);this.addSheet(ZUSE.SheetTypes.SHEET_AB,0,194,194,135,125,2);this.addSheet(ZUSE.SheetTypes.SHEET_AE,1,91,101,50,50,3);this.addSheet(ZUSE.SheetTypes.SHEET_AA,3,51,61,125,125,3);this.addSheet(ZUSE.SheetTypes.SHEET_AA,
1,131,141,125,125,3);this.addSheet(ZUSE.SheetTypes.SHEET_AE,2,51,61,50,50,4);this.addSheet(ZUSE.SheetTypes.SHEET_AA,2,91,101,125,125,4);this.addSheet(ZUSE.SheetTypes.SHEET_AA,0,171,181,125,125,4);this.addSheet(ZUSE.SheetTypes.SHEET_AP,"",-6,4,84,84,5);this.addSheet(ZUSE.SheetTypes.SHEET_AG,1,0,0,70,70,6);this.addStaticPin(25,75);this.addStaticPin(65,75);this.addStaticPin(105,75);this.addStaticPin(145,75);this.addStaticPin(185,75);this.addStaticPin(225,75);this.addStaticPin(65,155);this.addStaticPin(105,
155);this.addStaticPin(145,155);this.addStaticPin(185,155);this.addStaticPin(225,155);this.addMovingPin(80,90,100,90,"E3");this.addMovingPin(120,130,100,90,"E2");this.addMovingPin(160,170,100,90,"E1");this.addMovingPin(200,210,100,90,"E0");this.addMovingPin(80,90,140,130,"D3");this.addMovingPin(120,130,140,130,"D2");this.addMovingPin(160,170,140,130,"D1");this.addMovingPin(200,210,140,130,"D0");break;case ZUSE.LayerTypes.LAYER_B:this.levels=8;this.addSheet(ZUSE.SheetTypes.SHEET_BG,0,0,0,0,0,0);this.addSheet(ZUSE.SheetTypes.SHEET_BQ0,
"",-10,0,10,0,1);this.addSheet(ZUSE.SheetTypes.SHEET_BQ1,"",50,60,110,110,1);this.addSheet(ZUSE.SheetTypes.SHEET_BC,3,74,74,15,5,2);this.addSheet(ZUSE.SheetTypes.SHEET_BC,2,114,114,15,5,2);this.addSheet(ZUSE.SheetTypes.SHEET_BC,1,154,154,15,5,2);this.addSheet(ZUSE.SheetTypes.SHEET_BC,0,194,194,15,5,2);this.addSheet(ZUSE.SheetTypes.SHEET_BH,2,91,101,5,5,3);this.addSheet(ZUSE.SheetTypes.SHEET_BH,0,171,181,5,5,3);this.addSheet(ZUSE.SheetTypes.SHEET_BB,3,71,81,116,106,3);this.addSheet(ZUSE.SheetTypes.SHEET_BB,
2,111,121,116,106,3);this.addSheet(ZUSE.SheetTypes.SHEET_BB,1,151,161,116,106,3);this.addSheet(ZUSE.SheetTypes.SHEET_BB,0,191,201,116,106,3);this.addSheet(ZUSE.SheetTypes.SHEET_BH,3,51,61,5,5,4);this.addSheet(ZUSE.SheetTypes.SHEET_BH,1,131,141,5,5,4);this.addSheet(ZUSE.SheetTypes.SHEET_BA,3,61,71,125,125,4);this.addSheet(ZUSE.SheetTypes.SHEET_BA,1,141,151,125,125,4);this.addSheet(ZUSE.SheetTypes.SHEET_BF,3,51,61,61,61,4);this.addSheet(ZUSE.SheetTypes.SHEET_BF0,"",171,181,61,61,4);this.addSheet(ZUSE.SheetTypes.SHEET_BA,
2,101,111,125,125,5);this.addSheet(ZUSE.SheetTypes.SHEET_BA,0,181,191,125,125,5);this.addSheet(ZUSE.SheetTypes.SHEET_BF4,"",-30,-20,61,61,5);this.addSheet(ZUSE.SheetTypes.SHEET_BF,1,131,141,61,61,5);this.addSheet(ZUSE.SheetTypes.SHEET_BN,"",0,0,130,120,6);this.addSheet(ZUSE.SheetTypes.SHEET_BF,2,91,101,61,61,6);this.addSheet(ZUSE.SheetTypes.SHEET_BG,1,0,0,0,0,7);this.addStaticPin(65,35);this.addStaticPin(105,35);this.addStaticPin(145,35);this.addStaticPin(185,35);this.addStaticPin(225,35);this.addStaticPin(25,
75);this.addStaticPin(65,75);this.addStaticPin(105,75);this.addStaticPin(145,75);this.addStaticPin(185,75);this.addStaticPin(225,75);this.addStaticPin(75,155);this.addStaticPin(115,155);this.addStaticPin(155,155);this.addStaticPin(195,155);this.addStaticPin(235,155);this.addMovingPin(80,90,20,10,"H3");this.addMovingPin(120,130,20,10,"H2");this.addMovingPin(160,170,20,10,"H1");this.addMovingPin(200,210,20,10,"H0");this.addMovingPin(80,90,100,90,"G3");this.addMovingPin(120,130,100,90,"G2");this.addMovingPin(160,
170,100,90,"G1");this.addMovingPin(200,210,100,90,"G0");this.addMovingPin(65,75,115,115,"Q8");this.addMovingPin(105,115,115,115,"Q7");this.addMovingPin(145,155,115,115,"Q6");this.addMovingPin(185,195,115,115,"Q5");this.addMovingPin(225,235,115,115,"Q4");this.addMovingPin(80,90,140,130,"C3");this.addMovingPin(120,130,140,130,"C2");this.addMovingPin(160,170,140,130,"C1");this.addMovingPin(200,210,140,130,"C0");this.addMovingPin(85,95,230,230,"Q3",1,3);this.addMovingPin(125,135,230,230,"Q2",1,3);this.addMovingPin(165,
175,230,230,"Q1",1,3);this.addMovingPin(205,215,230,230,"Q0",1,3);break;case ZUSE.LayerTypes.LAYER_C:this.levels=7;this.addSheet(ZUSE.SheetTypes.SHEET_CG,0,0,0,0,0,0);this.addSheet(ZUSE.SheetTypes.SHEET_CV,"",34,34,135,125,1);this.addSheet(ZUSE.SheetTypes.SHEET_CK,2,114,114,76,66,1);this.addSheet(ZUSE.SheetTypes.SHEET_CK,0,194,194,76,66,1);this.addSheet(ZUSE.SheetTypes.SHEET_CR,"",0,0,5,-5,1);this.addSheet(ZUSE.SheetTypes.SHEET_CS,"",20,30,10,10,2);this.addSheet(ZUSE.SheetTypes.SHEET_CT,"",35,45,
125,125,3);this.addSheet(ZUSE.SheetTypes.SHEET_CW1,2,75,85,10,0,3);this.addSheet(ZUSE.SheetTypes.SHEET_CW1,0,155,165,10,0,3);this.addSheet(ZUSE.SheetTypes.SHEET_CU,"",0,0,125,115,4);this.addSheet(ZUSE.SheetTypes.SHEET_CW0,2,121,121,10,0,4);this.addSheet(ZUSE.SheetTypes.SHEET_CW0,0,201,201,10,0,4);this.addSheet(ZUSE.SheetTypes.SHEET_CM,2,114,114,125,115,5);this.addSheet(ZUSE.SheetTypes.SHEET_CM,0,194,194,125,115,5);this.addSheet(ZUSE.SheetTypes.SHEET_CF,2,91,101,61,61,5);this.addSheet(ZUSE.SheetTypes.SHEET_CF,
0,171,181,61,61,5);this.addSheet(ZUSE.SheetTypes.SHEET_CJ,2,91,101,11,11,5);this.addSheet(ZUSE.SheetTypes.SHEET_CJ,0,171,181,11,11,5);this.addSheet(ZUSE.SheetTypes.SHEET_CG,1,0,0,0,0,6);this.addStaticPin(105,35);this.addStaticPin(145,35);this.addStaticPin(185,35);this.addStaticPin(225,35);this.addStaticPin(105,75);this.addStaticPin(145,75);this.addStaticPin(185,75);this.addStaticPin(225,75);this.addStaticPin(25,155);this.addStaticPin(65,155);this.addStaticPin(105,155);this.addStaticPin(145,155);this.addStaticPin(185,
155);this.addStaticPin(225,155);this.addMovingPin(80,90,15,15,"S0");this.addMovingPin(120,130,20,10,"W2");this.addMovingPin(160,170,15,15,"S1");this.addMovingPin(200,210,20,10,"W0");this.addMovingPin(80,90,95,95,"S2");this.addMovingPin(120,130,100,90,"K2");this.addMovingPin(160,170,95,95,"S3");this.addMovingPin(200,210,100,90,"K0");this.addMovingPin(90,90,115,115,"Z0");this.addMovingPin(105,107,115,115,"Z1");this.addMovingPin(170,170,115,115,"Z2");this.addMovingPin(185,187,115,115,"Z3");this.addMovingPin(40,
50,140,130,"T");this.addMovingPin(120,130,140,130,"M2");this.addMovingPin(200,210,140,130,"M0");this.addMovingPin(45,45,210,200,"V",0,1);break;case ZUSE.LayerTypes.LAYER_D:this.levels=7;this.addSheet(ZUSE.SheetTypes.SHEET_DG,0,0,0,0,0,0);this.addSheet(ZUSE.SheetTypes.SHEET_DV,"",34,34,135,125,1);this.addSheet(ZUSE.SheetTypes.SHEET_DK,3,74,74,76,66,1);this.addSheet(ZUSE.SheetTypes.SHEET_DK,1,154,154,76,66,1);this.addSheet(ZUSE.SheetTypes.SHEET_DR,"",0,0,5,-5,1);this.addSheet(ZUSE.SheetTypes.SHEET_DS,
"",20,30,10,10,2);this.addSheet(ZUSE.SheetTypes.SHEET_DT,"",35,45,125,125,3);this.addSheet(ZUSE.SheetTypes.SHEET_DW1,3,35,45,10,0,3);this.addSheet(ZUSE.SheetTypes.SHEET_DW1,1,115,125,10,0,3);this.addSheet(ZUSE.SheetTypes.SHEET_DU,"",0,0,125,115,4);this.addSheet(ZUSE.SheetTypes.SHEET_DW0,3,81,81,10,0,4);this.addSheet(ZUSE.SheetTypes.SHEET_DW0,1,161,161,10,0,4);this.addSheet(ZUSE.SheetTypes.SHEET_DM,3,74,74,125,115,5);this.addSheet(ZUSE.SheetTypes.SHEET_DM,1,154,154,125,115,5);this.addSheet(ZUSE.SheetTypes.SHEET_DF,
3,51,61,61,61,5);this.addSheet(ZUSE.SheetTypes.SHEET_DF,1,131,141,61,61,5);this.addSheet(ZUSE.SheetTypes.SHEET_DJ,3,51,61,11,11,5);this.addSheet(ZUSE.SheetTypes.SHEET_DJ,1,131,141,11,11,5);this.addSheet(ZUSE.SheetTypes.SHEET_DG,1,0,0,0,0,6);this.addStaticPin(65,35);this.addStaticPin(105,35);this.addStaticPin(145,35);this.addStaticPin(185,35);this.addStaticPin(65,75);this.addStaticPin(105,75);this.addStaticPin(145,75);this.addStaticPin(185,75);this.addStaticPin(25,155);this.addStaticPin(65,155);this.addStaticPin(105,
155);this.addStaticPin(145,155);this.addStaticPin(185,155);this.addStaticPin(225,155);this.addMovingPin(40,50,15,15,"S0");this.addMovingPin(80,90,20,10,"W3");this.addMovingPin(120,130,15,15,"S1");this.addMovingPin(160,170,20,10,"W1");this.addMovingPin(40,50,95,95,"S2");this.addMovingPin(80,90,100,90,"K3");this.addMovingPin(120,130,95,95,"S3");this.addMovingPin(160,170,100,90,"K1");this.addMovingPin(103,105,115,115,"Z1");this.addMovingPin(120,120,115,115,"Z0");this.addMovingPin(183,185,115,115,"Z3");
this.addMovingPin(200,200,115,115,"Z2");this.addMovingPin(40,50,140,130,"T");this.addMovingPin(80,90,140,130,"M3");this.addMovingPin(160,170,140,130,"M1");this.addMovingPin(45,45,210,200,"V",1,6);break;case ZUSE.LayerTypes.LAYER_0A:this.levels=1.5;this.spacing=10;this.intermediate=!0;this.addIntermediateSheet(ZUSE.SheetTypes.SHEET_Z0A,0,70);this.addStaticPin(25,75);this.addStaticPin(65,75);this.addStaticPin(105,75);this.addStaticPin(145,75);this.addStaticPin(185,75);this.addStaticPin(225,75);this.addStaticPin(65,
155);this.addStaticPin(105,155);this.addStaticPin(145,155);this.addStaticPin(185,155);this.addStaticPin(225,155);break;case ZUSE.LayerTypes.LAYER_AB:this.levels=1.5;this.spacing=10;this.intermediate=!0;this.addIntermediateSheet(ZUSE.SheetTypes.SHEET_ZAB,0,0);this.addStaticPin(65,35);this.addStaticPin(105,35);this.addStaticPin(145,35);this.addStaticPin(185,35);this.addStaticPin(225,35);this.addStaticPin(25,75);this.addStaticPin(65,75);this.addStaticPin(105,75);this.addStaticPin(145,75);this.addStaticPin(185,
75);this.addStaticPin(225,75);this.addStaticPin(65,155,1,3);this.addStaticPin(105,155,1,3);this.addStaticPin(145,155,1,3);this.addStaticPin(185,155,1,3);this.addStaticPin(225,155,1,3);this.addStaticPin(75,155,0,2);this.addStaticPin(115,155,0,2);this.addStaticPin(155,155,0,2);this.addStaticPin(195,155,0,2);this.addStaticPin(235,155,0,2);break;case ZUSE.LayerTypes.LAYER_BC:this.levels=1.5;this.spacing=10;this.intermediate=!0;this.addIntermediateSheet(ZUSE.SheetTypes.SHEET_ZBC,0,0);this.addStaticPin(65,
35,1,3);this.addStaticPin(105,35);this.addStaticPin(145,35);this.addStaticPin(185,35);this.addStaticPin(225,35);this.addStaticPin(25,75,1,3);this.addStaticPin(65,75,1,3);this.addStaticPin(105,75);this.addStaticPin(145,75);this.addStaticPin(185,75);this.addStaticPin(225,75);this.addStaticPin(25,155,0,2);this.addStaticPin(65,155,0,2);this.addStaticPin(105,155,0,2);this.addStaticPin(145,155,0,2);this.addStaticPin(185,155,0,2);this.addStaticPin(225,155,0,2);this.addStaticPin(75,155,1,3);this.addStaticPin(115,
155,1,3);this.addStaticPin(155,155,1,3);this.addStaticPin(195,155,1,3);this.addStaticPin(235,155,1,3);break;case ZUSE.LayerTypes.LAYER_CD:this.levels=1.5;this.spacing=10;this.intermediate=!0;this.addIntermediateSheet(ZUSE.SheetTypes.SHEET_ZCD,0,0);this.addStaticPin(65,35,0,2);this.addStaticPin(105,35);this.addStaticPin(145,35);this.addStaticPin(185,35);this.addStaticPin(225,35,1,3);this.addStaticPin(65,75,0,2);this.addStaticPin(105,75);this.addStaticPin(145,75);this.addStaticPin(185,75);this.addStaticPin(225,
75,1,3);this.addStaticPin(25,155);this.addStaticPin(65,155);this.addStaticPin(105,155);this.addStaticPin(145,155);this.addStaticPin(185,155);this.addStaticPin(225,155);this.addMovingPin(45,45,210,200,"V");break;case ZUSE.LayerTypes.LAYER_D0:this.levels=1.5,this.spacing=10,this.intermediate=!0,this.addIntermediateSheet(ZUSE.SheetTypes.SHEET_ZD0,0,0),this.addStaticPin(65,35),this.addStaticPin(105,35),this.addStaticPin(145,35),this.addStaticPin(185,35),this.addStaticPin(65,75),this.addStaticPin(105,
75),this.addStaticPin(145,75),this.addStaticPin(185,75),this.addStaticPin(25,155),this.addStaticPin(65,155),this.addStaticPin(105,155),this.addStaticPin(145,155),this.addStaticPin(185,155),this.addStaticPin(225,155)}this.addStaticPin(0,90,6);this.addStaticPin(240,90,6);this.addMovingPin(80,90,50,50,"J3");this.addMovingPin(120,130,50,50,"J2");this.addMovingPin(160,170,50,50,"J1");this.addMovingPin(200,210,50,50,"J0");this.addMovingPin(40,50,60,60,"F4");this.addMovingPin(80,90,60,60,"F3");this.addMovingPin(120,
130,60,60,"F2");this.addMovingPin(160,170,60,60,"F1");this.addMovingPin(200,210,60,60,"F0");this.addMovingPin(80,90,180,180,"A3");this.addMovingPin(120,130,180,180,"A2");this.addMovingPin(160,170,180,180,"A1");this.addMovingPin(200,210,180,180,"A0");this.addMovingPin(85,85,210,200,"B3");this.addMovingPin(125,125,210,200,"B2");this.addMovingPin(165,165,210,200,"B1");this.addMovingPin(205,205,210,200,"B0");this.addMovingPin(0,0,10,0,"Y0",6);this.addMovingPin(240,240,10,0,"Y1",6);this.addMovingPin(270,
280,10,10,"X0",6);this.addMovingPin(0,0,130,120,"Y2",6);this.addMovingPin(240,240,130,120,"Y3",6);this.addMovingPin(270,280,130,130,"X1",6)};
ZUSE.Layer.prototype={constructor:ZUSE.Layer,addSheet:function(b,c,d,e,f,g,h){c=b+c;b=new ZUSE.Sheet([this.type,c],b,d,e,f,g,2*h+1,this.spacing,!1,d!==e||f!==g);this.meshes.add(b.mesh);this.sheets.push(b);this.cycleAccess[c]=b;this.parent.selectables2.push(b.mesh)},addIntermediateSheet:function(b,c,d){b=new ZUSE.Sheet([this.type,b],b,c,c,d,d,1.5,this.spacing,!0,!1);this.meshes.add(b.mesh);this.sheets.push(b);this.parent.selectables2.push(b.mesh)},addStaticPin:function(b,c,d,e){var f,g=4;switch(arguments.length){case 3:g=
d;case 2:f=new ZUSE.Pin(null,b,b,c,c,0,2*this.levels,this.spacing,g,!1);break;case 4:f=new ZUSE.Pin(null,b,b,c,c,d,e,this.spacing,g,!1)}this.meshes.add(f.mesh);this.pins.push(f);this.parent.selectables2.push(f.mesh)},addMovingPin:function(b,c,d,e,f,g,h,k){var i,j=4,l=!1;switch(arguments.length){case 6:l=!0,j=g;case 5:i=new ZUSE.Pin([this.type,f],b,c,d,e,0,2*this.levels,this.spacing,j,!0);break;case 8:l=!0,j=k;case 7:i=new ZUSE.Pin([this.type,f],b,c,d,e,2*g,2*h+2,this.spacing,j,!0)}this.meshes.add(i.mesh);
this.pins.push(i);this.cycleAccess[f]=i;l&&this.parent.pulsers.push(i);this.parent.selectables2.push(i.mesh)},changeSpacing:function(){for(var b=0;b<this.sheets.length;b++)this.sheets[b].setHeight(this.sheets[b].level*this.spacing);for(b=0;b<this.pins.length;b++)this.pins[b].setHeight(this.pins[b].l1*this.spacing,this.pins[b].l2*this.spacing)},getHeight:function(){return 2*this.levels*this.spacing},setVisibility:function(b){for(var c=0;c<this.meshes.children.length;c++)this.meshes.children[c].visible=
b}};ZUSE.Adder=function(){this.meshes=new THREE.Object3D;this.layers=[];this.getLayerNumber={};this.layersByType={};this.pulsers=[];this.spacingClosed=3;this.spacingOpen=20;this.cycleControl=new ZUSE.CycleControl(this);this.selectables=[];this.selectables2=[];this.selectables2enabled=!1;this.addLayer(ZUSE.LayerTypes.LAYER_D0);this.addLayer(ZUSE.LayerTypes.LAYER_D);this.addLayer(ZUSE.LayerTypes.LAYER_CD);this.addLayer(ZUSE.LayerTypes.LAYER_C);this.addLayer(ZUSE.LayerTypes.LAYER_BC);this.addLayer(ZUSE.LayerTypes.LAYER_B);
this.addLayer(ZUSE.LayerTypes.LAYER_AB);this.addLayer(ZUSE.LayerTypes.LAYER_A);this.addLayer(ZUSE.LayerTypes.LAYER_0A);this.layersByType.In=new ZUSE.InputControlLayer;this.selection=new ZUSE.Selection({x1:-40,x2:320,y1:-15,y2:265},this);this.meshes.add(this.selection.meshes);ZUSE.scene.add(this.meshes)};
ZUSE.Adder.prototype={constructor:ZUSE.Adder,addLayer:function(b){var c=new ZUSE.Layer(b,this.spacingClosed,this);this.meshes.add(c.meshes);this.layers.push(c);this.getLayerNumber[b]=this.layers.length-1;this.layersByType[b]=c;this.setHeight(this.layers.length-1)},setHeight:function(b){0<b&&(this.layers[b].meshes.position.z=this.layers[b-1].meshes.position.z+this.layers[b-1].getHeight())},changeSpacing:function(b){if(!this.layers[b].intermediate){var c=this.layers[b].open?this.spacingClosed:this.spacingOpen;
this.layers[b].open=!this.layers[b].open;c=(new TWEEN.Tween(this.layers[b])).to({spacing:c},1E3);c.onUpdate(function(){this.changeSpacing();for(var c=b+1;c<this.parent.layers.length;c++)this.parent.setHeight(c);this.parent.selection.updateBoxHeight();this.parent.selection.updateHeightLimit()});c.easing(TWEEN.Easing.Quadratic.EaseInOut);c.start()}}};ZUSE.SVGUtils={gates:{svgGateD3:{active:!1,x1:74,x2:106,y1:125,y2:225,z1:7,z2:7},svgGateD2:{active:!1,x1:114,x2:146,y1:125,y2:225,z1:7,z2:7},svgGateD1:{active:!1,x1:154,x2:186,y1:125,y2:225,z1:7,z2:7},svgGateD0:{active:!1,x1:194,x2:226,y1:125,y2:225,z1:7,z2:7},svgGateC3:{active:!1,x1:71,x2:110,y1:110,y2:255,z1:5,z2:5},svgGateC2:{active:!1,x1:111,x2:150,y1:110,y2:255,z1:5,z2:5},svgGateC1:{active:!1,x1:151,x2:190,y1:110,y2:255,z1:5,z2:5},svgGateC0:{active:!1,x1:191,x2:230,y1:110,y2:255,z1:5,z2:5},svgGateF4:{active:!1,
x1:26,x2:60,y1:60,y2:90,z1:5,z2:7},svgGateF3:{active:!1,x1:66,x2:100,y1:60,y2:90,z1:5,z2:7},svgGateF2:{active:!1,x1:106,x2:140,y1:60,y2:90,z1:5,z2:7},svgGateF1:{active:!1,x1:146,x2:180,y1:60,y2:90,z1:5,z2:7},svgGateH3:{active:!1,x1:74,x2:106,y1:70,y2:110,z1:5,z2:5},svgGateH2:{active:!1,x1:114,x2:146,y1:70,y2:110,z1:5,z2:5},svgGateH1:{active:!1,x1:154,x2:186,y1:70,y2:110,z1:5,z2:5},svgGateH0:{active:!1,x1:194,x2:226,y1:70,y2:110,z1:5,z2:5},svgGateN3:{active:!1,x1:64,x2:106,y1:5,y2:45,z1:5,z2:5},svgGateN2:{active:!1,
x1:106,x2:146,y1:5,y2:45,z1:5,z2:5},svgGateN1:{active:!1,x1:146,x2:186,y1:5,y2:45,z1:5,z2:5},svgGateN0:{active:!1,x1:186,x2:226,y1:5,y2:45,z1:5,z2:5},svgGateJ3:{active:!1,x1:60,x2:95,y1:45,y2:60,z1:5,z2:7},svgGateJ2:{active:!1,x1:100,x2:135,y1:45,y2:60,z1:5,z2:7},svgGateJ1:{active:!1,x1:140,x2:175,y1:45,y2:60,z1:5,z2:7},svgGateJ0:{active:!1,x1:180,x2:215,y1:45,y2:60,z1:5,z2:7},svgGateK3:{active:!1,x1:35,x2:120,y1:10,y2:115,z1:1,z2:1},svgGateK2:{active:!1,x1:75,x2:160,y1:10,y2:115,z1:3,z2:3},svgGateK1:{active:!1,
x1:115,x2:200,y1:10,y2:115,z1:1,z2:1},svgGateK0:{active:!1,x1:155,x2:240,y1:10,y2:115,z1:3,z2:3}},reset:function(){for(var b in this.gates){this.gates[b].active=!1;var c=document.getElementById(b);null!==c?c.setAttribute("fill","white"):console.warn("undefined element in SVGUtils.gates")}},onclick:function(b){this.reset();this.gates[b.id].active=!0;b.setAttribute("fill","#59b1d4");ZUSE.adderObj.selection.setFromCircuit(this.gates[b.id])},mouseover:function(b){document.body.style.cursor="pointer";
b.setAttribute("fill",this.gates[b.id].active?"#59b1d4":"#b0d9e8")},mouseout:function(b){document.body.style.cursor="auto";b.setAttribute("fill",this.gates[b.id].active?"#59b1d4":"white")}};ZUSE.XMLUtils={loadXML:function(b){var c=new XMLHttpRequest;c.open("GET",b,!1);c.setRequestHeader("Content-Type","text/xml");c.send("");return c.responseXML}};ZUSE.Initializer=function(){function b(){requestAnimationFrame(b);ZUSE.controls.update();ZUSE.renderer.render(ZUSE.scene,ZUSE.camera);TWEEN.update()}function c(b){b.stopPropagation()}var d;try{d=!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(e){d=!1}d||(document.getElementById("webglError").style.display="block");ZUSE.INTERSECTED=void 0;ZUSE.SELECTED=void 0;ZUSE.mouse=new THREE.Vector2;ZUSE.offset=new THREE.Vector3;ZUSE.container=document.getElementById("webgl_01");
ZUSE.scene=new THREE.Scene;ZUSE.camera=new THREE.PerspectiveCamera(50,(window.innerWidth-20)/(window.innerHeight-20),25,2500);ZUSE.camera.position.set(0,0,500);ZUSE.scene.add(ZUSE.camera);document.getElementById("log").addEventListener("mousewheel",c,!1);document.getElementById("log").addEventListener("DOMMouseScroll",c,!1);ZUSE.controls=new ZUSE.CameraControls(ZUSE.camera);ZUSE.controls.reset();ZUSE.adderObj=new ZUSE.Adder;ZUSE.plane=new THREE.Mesh(new THREE.PlaneGeometry(2E3,2E3,8,8),new THREE.MeshBasicMaterial({color:0,
opacity:0.25,transparent:!0,wireframe:!0}));ZUSE.plane.visible=!1;ZUSE.scene.add(ZUSE.plane);ZUSE.projector=new THREE.Projector;ZUSE.renderer=new THREE.WebGLRenderer({antialias:!0});ZUSE.renderer.setSize(window.innerWidth,window.innerHeight);ZUSE.container.appendChild(ZUSE.renderer.domElement);document.addEventListener("mousemove",function(b){var c=ZUSE.adderObj.selection.enabled;if(c||ZUSE.adderObj.selectables2enabled){b.preventDefault();ZUSE.mouse.x=b.clientX/window.innerWidth*2-1;ZUSE.mouse.y=
-(b.clientY/window.innerHeight)*2+1;b=new THREE.Vector3(ZUSE.mouse.x,ZUSE.mouse.y,0.5);ZUSE.projector.unprojectVector(b,ZUSE.camera);b=new THREE.Ray(ZUSE.camera.position,b.subSelf(ZUSE.camera.position).normalize());if(ZUSE.SELECTED){b=b.intersectObject(ZUSE.plane);c=b[0].point.subSelf(ZUSE.offset);ZUSE.adderObj.selection.setFromMouse(ZUSE.SELECTED.axis,c[ZUSE.SELECTED.axis.a],true)}else{b=b.intersectObjects(c?ZUSE.adderObj.selectables:ZUSE.adderObj.selectables2);if(b.length>0){var d;if(c)d=b[0].object;
else for(var e=false,i=0,j=ZUSE.adderObj.selection.values;!e&&b[i];){var l=b[i].point;if(l.x>=j.x1&&l.x<=j.x2&&l.y>=j.y1&&l.y<=j.y2&&l.z>=j.z1&&l.z<=j.z2){d=b[i].object;e=true}i++}if(d!==void 0){if(ZUSE.INTERSECTED!=d){if(ZUSE.INTERSECTED)ZUSE.INTERSECTED.material=c?ZUSE.Materials.BoxWireframe:ZUSE.INTERSECTED.defaultMaterial;ZUSE.INTERSECTED=b[0].object;ZUSE.INTERSECTED.material=c?ZUSE.Materials.BoxWireActive:ZUSE.Materials.Highlight.shader;ZUSE.plane.position.copy(ZUSE.INTERSECTED.position);ZUSE.plane.lookAt(ZUSE.camera.position)}document.body.style.cursor=
"pointer"}else{if(ZUSE.INTERSECTED)ZUSE.INTERSECTED.material=c?ZUSE.Materials.BoxWireframe:ZUSE.INTERSECTED.defaultMaterial;ZUSE.INTERSECTED=null;document.body.style.cursor="auto"}}else{if(ZUSE.INTERSECTED)ZUSE.INTERSECTED.material=c?ZUSE.Materials.BoxWireframe:ZUSE.INTERSECTED.defaultMaterial;ZUSE.INTERSECTED=null;document.body.style.cursor="auto"}}}},!1);document.addEventListener("mousedown",function(b){if(ZUSE.adderObj.selection.enabled){b.preventDefault();b=new THREE.Vector3(ZUSE.mouse.x,ZUSE.mouse.y,
0.5);ZUSE.projector.unprojectVector(b,ZUSE.camera);var b=new THREE.Ray(ZUSE.camera.position,b.subSelf(ZUSE.camera.position).normalize()),c=b.intersectObjects(ZUSE.adderObj.selectables);if(c.length>0){ZUSE.SELECTED=c[0].object;ZUSE.adderObj.selection.dragStart(ZUSE.SELECTED.axis);c=b.intersectObject(ZUSE.plane);ZUSE.offset.copy(c[0].point).subSelf(ZUSE.plane.position);document.body.style.cursor="move"}}},!1);document.addEventListener("mouseup",function(b){if(ZUSE.adderObj.selection.enabled){b.preventDefault();
if(ZUSE.INTERSECTED){ZUSE.plane.position.copy(ZUSE.INTERSECTED.position);ZUSE.SELECTED=null}document.body.style.cursor="pointer"}},!1);window.addEventListener("resize",function(){ZUSE.camera.aspect=window.innerWidth/window.innerHeight;ZUSE.camera.updateProjectionMatrix();ZUSE.renderer.setSize(window.innerWidth,window.innerHeight)},!1);document.getElementById("tabs-1").addEventListener("mousedown",c,!1);document.getElementById("tabs-3").addEventListener("mousedown",c,!1);document.getElementById("tabs-4").addEventListener("mousedown",
c,!1);document.getElementById("tabs-5").addEventListener("mousedown",c,!1);document.getElementById("tabs-6").addEventListener("mousedown",c,!1);document.getElementById("tabs-8").addEventListener("mousedown",c,!1);document.getElementById("floatingCircuit").addEventListener("mousedown",c,!1);document.addEventListener("selectstart",function(b){b.preventDefault();b.stopPropagation()},!1);d=document.getElementById("floatingCircuit");d.insertBefore(ZUSE.XMLUtils.loadXML("projects/adder/circuit.svg").lastChild,
d.childNodes[0]);b()};
